#!/bin/bash

set -e

curr_dir="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

if [ "$#" -lt 1 ]; then
    printf "%s 3\n" \
  "You have to specify a command which corresponds to the filename \
   in internals/ci"
fi

check_rust="$curr_dir/internals/ci/_check_rust.sh"

if ! $check_rust; then
    printf "Error checking if rust is sane in your system\n"
    exit 1
fi

ci_cargo="$curr_dir/internals/ci/Cargo.toml"
PROJECT_ROOT=$curr_dir cargo run --manifest-path=$ci_cargo -- "$@"

# filePath="$currDir/internals/ci/$command.sh"

# if [[ ! -f $filePath ]]; then
#     printf "Error finding a command [%s] at %s\n" $command $filePath
#     exit 1
# fi

# ROOT_PATH=$currDir $filePath "${@:2}"
